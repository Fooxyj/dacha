<div class="module custom-dashboard" style="margin-bottom: 20px;">
    <h2>üìä –°–≤–æ–¥–∫–∞ –∑–∞ —Å–µ–≥–æ–¥–Ω—è ({% now "d.m.Y" %})</h2>
    <div style="display: flex; gap: 20px; flex-wrap: wrap;">
        <!-- Traffic -->
        <div
            style="flex: 1; background: #fff; padding: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); border: 1px solid #e0e0e0;">
            <h3 style="margin-top: 0; color: #666; font-size: 13px; text-transform: uppercase;">–¢—Ä–∞—Ñ–∏–∫</h3>
            <div style="font-size: 24px; font-weight: bold; color: #333;">
                {{ unique_visitors }} <span
                    style="font-size: 14px; font-weight: normal; color: #888;">–ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π</span>
            </div>
            <div style="font-size: 13px; color: #888; margin-top: 5px;">
                –ü—Ä–æ—Å–º–æ—Ç—Ä–æ–≤: {{ total_views }}
            </div>
        </div>

        <!-- Revenue Today -->
        <div
            style="flex: 1; background: #fff; padding: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); border: 1px solid #e0e0e0;">
            <h3 style="margin-top: 0; color: #666; font-size: 13px; text-transform: uppercase;">–í—ã—Ä—É—á–∫–∞ –∑–∞ —Å–µ–≥–æ–¥–Ω—è</h3>
            <div style="font-size: 24px; font-weight: bold; color: #28a745;">
                {{ revenue_today|default:"0" }} ‚ÇΩ
            </div>
            <div style="font-size: 13px; color: #888; margin-top: 5px;">
                –ó–∞–∫–∞–∑–æ–≤: {{ orders_count_today }}
            </div>
        </div>

        <!-- Total Revenue -->
        <div
            style="flex: 1; background: #fff; padding: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); border: 1px solid #e0e0e0;">
            <h3 style="margin-top: 0; color: #666; font-size: 13px; text-transform: uppercase;">–í—ã—Ä—É—á–∫–∞ –≤—Å–µ–≥–æ</h3>
            <div style="font-size: 24px; font-weight: bold; color: #333;">
                {{ revenue_total|default:"0" }} ‚ÇΩ
            </div>
        </div>

        <!-- Reservations -->
        <div
            style="flex: 1; background: #fff; padding: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); border: 1px solid #e0e0e0;">
            <h3 style="margin-top: 0; color: #666; font-size: 13px; text-transform: uppercase;">–ë—Ä–æ–Ω–∏ —Å—Ç–æ–ª–æ–≤</h3>
            <div style="font-size: 24px; font-weight: bold; color: #007bff;">
                {{ reservations_today }}
            </div>
            <div style="font-size: 13px; color: #888; margin-top: 5px;">
                –Ω–∞ —Å–µ–≥–æ–¥–Ω—è
            </div>
        </div>
    </div>

    <!-- New Orders Table -->
    <div
        style="margin-top: 20px; background: #222; padding: 15px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.3); border: 1px solid #444; color: #fff;">
        <h3
            style="margin-top: 0; margin-bottom: 15px; color: #fff; font-size: 16px; border-bottom: 1px solid #444; padding-bottom: 10px;">
            üçï –ù–æ–≤—ã–µ –∑–∞–∫–∞–∑—ã (–¢—Ä–µ–±—É—é—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏)
        </h3>

        {% if latest_new_orders %}
        <table style="width: 100%; border-collapse: collapse; font-size: 14px;">
            <thead>
                <tr style="border-bottom: 2px solid #555; text-align: left;">
                    <th style="padding: 10px; color: #aaa;">‚Ññ –ó–∞–∫–∞–∑–∞</th>
                    <th style="padding: 10px; color: #aaa;">–í—Ä–µ–º—è</th>
                    <th style="padding: 10px; color: #aaa;">–ö–ª–∏–µ–Ω—Ç</th>
                    <th style="padding: 10px; color: #aaa;">–°—É–º–º–∞</th>
                    <th style="padding: 10px; color: #aaa;">–û–ø–ª–∞—Ç–∞</th>
                    <th style="padding: 10px; color: #aaa;">–î–µ–π—Å—Ç–≤–∏–µ</th>
                </tr>
            </thead>
            <tbody>
                {% for order in latest_new_orders %}
                <tr style="border-bottom: 1px solid #333; background-color: #2a2a2a;">
                    <td style="padding: 10px; font-weight: bold; color: #fff;">#{{ order.id }}</td>
                    <td style="padding: 10px; color: #ddd;">{{ order.created_at|date:"d.m H:i" }}</td>
                    <td style="padding: 10px;">
                        <div style="color: #fff;">{{ order.name }}</div>
                        <div style="font-size: 11px; color: #aaa;">{{ order.phone }}</div>
                    </td>
                    <td style="padding: 10px; font-weight: bold; color: #4ade80;">{{ order.total_price }} ‚ÇΩ</td>
                    <td style="padding: 10px; color: #ddd;">
                        {% if order.payment_method == 'online' %}üí≥ –û–Ω–ª–∞–π–Ω{% elif order.payment_method == 'transfer'
                        %}üì± –ü–µ—Ä–µ–≤–æ–¥{% else %}üíµ –ù–∞–ª–∏—á–Ω—ã–µ{% endif %}
                    </td>
                    <td style="padding: 10px;">
                        <a href="{% url 'admin:api_order_change' order.id %}"
                            style="display: inline-block; padding: 6px 12px; background: #007bff; border-radius: 4px; text-decoration: none; color: #fff; font-size: 12px; font-weight: bold;">
                            –û–±—Ä–∞–±–æ—Ç–∞—Ç—å
                        </a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p style="color: #aaa; padding: 10px;">–ù–µ—Ç –Ω–æ–≤—ã—Ö –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤.</p>
        {% endif %}
    </div>

    <!-- Upcoming Reservations Table -->
    <div
        style="margin-top: 20px; background: #222; padding: 15px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.3); border: 1px solid #444; color: #fff;">
        <h3
            style="margin-top: 0; margin-bottom: 15px; color: #fff; font-size: 16px; border-bottom: 1px solid #444; padding-bottom: 10px;">
            üìÖ –ë–ª–∏–∂–∞–π—à–∏–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (10 —à—Ç.)</h3>

        {% if upcoming_reservations %}
        <table style="width: 100%; border-collapse: collapse; font-size: 14px;">
            <thead>
                <tr style="border-bottom: 2px solid #555; text-align: left;">
                    <th style="padding: 10px; color: #aaa;">–î–∞—Ç–∞</th>
                    <th style="padding: 10px; color: #aaa;">–í—Ä–µ–º—è</th>
                    <th style="padding: 10px; color: #aaa;">–ò–º—è</th>
                    <th style="padding: 10px; color: #aaa;">–ì–æ—Å—Ç–µ–π</th>
                    <th style="padding: 10px; color: #aaa;">–¢–µ–ª–µ—Ñ–æ–Ω</th>
                    <th style="padding: 10px; color: #aaa;">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</th>
                    <th style="padding: 10px; color: #aaa;">–î–µ–π—Å—Ç–≤–∏–µ</th>
                </tr>
            </thead>
            <tbody>
                {% for res in upcoming_reservations %}
                <tr style="border-bottom: 1px solid #333; background-color: #2a2a2a;">
                    <td style="padding: 10px; font-weight: bold; color: #fff;">{{ res.date|date:"d.m.Y" }}</td>
                    <td style="padding: 10px; color: #ddd;">{{ res.time|time:"H:i" }}</td>
                    <td style="padding: 10px; color: #fff;">{{ res.name }}</td>
                    <td style="padding: 10px; color: #ddd;">{{ res.guests }} —á–µ–ª.</td>
                    <td style="padding: 10px; color: #ddd;">{{ res.phone }}</td>
                    <td style="padding: 10px; color: #888; font-style: italic;">{{ res.comment|truncatechars:30 }}</td>
                    <td style="padding: 10px;">
                        <a href="{% url 'admin:api_reservation_change' res.id %}"
                            style="display: inline-block; padding: 5px 10px; background: #f8f9fa; border: 1px solid #ddd; border-radius: 4px; text-decoration: none; color: #333; font-size: 12px;">
                            ‚úèÔ∏è –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                        </a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p style="color: #aaa; padding: 10px;">–ù–∞ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π –Ω–µ—Ç.</p>
        {% endif %}
    </div>
</div>